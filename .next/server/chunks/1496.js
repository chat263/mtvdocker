"use strict";exports.id=1496,exports.ids=[1496],exports.modules={22106:(e,t,r)=>{r.d(t,{Z:()=>s});var o=r(19681);let s=({aspectRatio:e})=>o.jsx("div",{className:`w-full ${e} rounded-lg`,style:{background:"linear-gradient(90deg, var(--skeleton-color) 25%, var(--skeleton-highlight) 50%, var(--skeleton-color) 75%)",backgroundSize:"200% 100%",animation:"shine 1.5s infinite"},children:o.jsx("style",{children:`
      @keyframes shine {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      
      /* 亮色模式变量 */
      :root {
        --skeleton-color: #f0f0f0;
        --skeleton-highlight: #e0e0e0;
      }
      
      /* 暗色模式变量 */
      @media (prefers-color-scheme: dark) {
        :root {
          --skeleton-color: #2d2d2d;
          --skeleton-highlight: #3d3d3d;
        }
      }
      
      .dark {
        --skeleton-color: #2d2d2d;
        --skeleton-highlight: #3d3d3d;
      }
    `})})},61496:(e,t,r)=>{r.d(t,{Z:()=>g});var o=r(19681),s=r(61824),a=r(46632),i=r(39190),n=r(29601),l=r(29872),d=r(18202),c=r(73301),h=r(73469),u=r(94434),p=r(22106);function g({id:e,title:t="",query:r="",poster:g="",episodes:m,source:x,source_name:b,progress:v=0,year:w,from:f,currentEpisode:y,douban_id:k,onDelete:j,rate:N,items:C,type:$="",isBangumi:P=!1}){let D=(0,d.useRouter)(),[S,R]=(0,c.useState)(!1),[_,z]=(0,c.useState)(!1),E="search"===f&&!!C?.length,L=(0,c.useMemo)(()=>{if(!E||!C)return null;let e=new Map,t=new Map;C.forEach(r=>{r.douban_id&&0!==r.douban_id&&e.set(r.douban_id,(e.get(r.douban_id)||0)+1);let o=r.episodes?.length||0;o>0&&t.set(o,(t.get(o)||0)+1)});let r=e=>{let t,r=0;return e.forEach((e,o)=>{e>r&&(r=e,t=o)}),t};return{first:C[0],mostFrequentDoubanId:r(e),mostFrequentEpisodes:r(t)||0}},[E,C]),Z=L?.first.title??t,H=L?.first.poster??g,q=L?.first.source??x,B=L?.first.id??e,I=L?.mostFrequentDoubanId??k,Y=L?.mostFrequentEpisodes??m,F=L?.first.year??w,M=r||"",U=E?L?.first.episodes?.length===1?"movie":"tv":$,O=(0,c.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),"douban"!==f&&"search"!==f&&q&&B)try{S?(await (0,h.r7)(q,B),R(!1)):(await (0,h.qn)(q,B,{title:Z,source_name:b||"",year:F||"",cover:H,total_episodes:Y??1,save_time:Date.now()}),R(!0))}catch(e){throw Error("切换收藏状态失败")}},[f,q,B,Z,b,F,H,Y,S]),T=(0,c.useCallback)(async e=>{if(e.preventDefault(),e.stopPropagation(),"playrecord"===f&&q&&B)try{await (0,h.Ji)(q,B),j?.()}catch(e){throw Error("删除播放记录失败")}},[f,q,B,j]),A=(0,c.useCallback)(()=>{"douban"===f?D.push(`/play?title=${encodeURIComponent(Z.trim())}${F?`&year=${F}`:""}${U?`&stype=${U}`:""}`):q&&B&&D.push(`/play?source=${q}&id=${B}&title=${encodeURIComponent(Z)}${F?`&year=${F}`:""}${E?"&prefer=true":""}${M?`&stitle=${encodeURIComponent(M.trim())}`:""}${U?`&stype=${U}`:""}`)},[f,q,B,D,Z,F,E,M,U]),J=(0,c.useMemo)(()=>{let e={playrecord:{showSourceName:!0,showProgress:!0,showPlayButton:!0,showHeart:!0,showCheckCircle:!0,showDoubanLink:!1,showRating:!1,showYear:!1},favorite:{showSourceName:!0,showProgress:!1,showPlayButton:!0,showHeart:!0,showCheckCircle:!1,showDoubanLink:!1,showRating:!1,showYear:!1},search:{showSourceName:!0,showProgress:!1,showPlayButton:!0,showHeart:!1,showCheckCircle:!1,showDoubanLink:!1,showRating:!1,showYear:!0},douban:{showSourceName:!1,showProgress:!1,showPlayButton:!0,showHeart:!1,showCheckCircle:!1,showDoubanLink:!0,showRating:!!N,showYear:!1}};return e[f]||e.search},[f,E,I,N]);return(0,o.jsxs)("div",{className:"group relative w-full rounded-lg bg-transparent cursor-pointer transition-all duration-300 ease-in-out hover:scale-[1.05] hover:z-[500]",onClick:A,children:[(0,o.jsxs)("div",{className:"relative aspect-[2/3] overflow-hidden rounded-lg",children:[!_&&o.jsx(p.Z,{aspectRatio:"aspect-[2/3]"}),o.jsx(l.default,{src:(0,u.a8)(H),alt:Z,fill:!0,className:"object-cover",referrerPolicy:"no-referrer",loading:"lazy",onLoadingComplete:()=>z(!0),onError:e=>{let t=e.target;t.dataset.retried||(t.dataset.retried="true",setTimeout(()=>{t.src=(0,u.a8)(H)},2e3))}}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 transition-opacity duration-300 ease-in-out group-hover:opacity-100"}),J.showPlayButton&&o.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-300 ease-in-out delay-75 group-hover:opacity-100 group-hover:scale-100",children:o.jsx(s.Z,{size:50,strokeWidth:.8,className:"text-white fill-transparent transition-all duration-300 ease-out hover:fill-green-500 hover:scale-[1.1]"})}),(J.showHeart||J.showCheckCircle)&&(0,o.jsxs)("div",{className:"absolute bottom-3 right-3 flex gap-3 opacity-0 translate-y-2 transition-all duration-300 ease-in-out group-hover:opacity-100 group-hover:translate-y-0",children:[J.showCheckCircle&&o.jsx(a.Z,{onClick:T,size:20,className:"text-white transition-all duration-300 ease-out hover:stroke-red-500 hover:scale-[1.1]"}),J.showHeart&&o.jsx(i.Z,{onClick:O,size:20,className:`transition-all duration-300 ease-out ${S?"fill-red-600 stroke-red-600":"fill-transparent stroke-white hover:stroke-red-400"} hover:scale-[1.1]`})]}),J.showYear&&F&&"unknown"!==F&&""!==F.trim()&&o.jsx("div",{className:`absolute top-2 bg-black/50 text-white text-xs font-medium px-2 py-1 rounded backdrop-blur-sm shadow-sm transition-all duration-300 ease-out group-hover:opacity-90 ${J.showDoubanLink&&I&&0!==I?"left-2 group-hover:left-11":"left-2"}`,children:F}),J.showRating&&N&&o.jsx("div",{className:"absolute top-2 right-2 bg-pink-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md transition-all duration-300 ease-out group-hover:scale-110",children:N}),Y&&Y>1&&o.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs font-semibold px-2 py-1 rounded-md shadow-md transition-all duration-300 ease-out group-hover:scale-110",children:y?`${y}/${Y}`:Y}),J.showDoubanLink&&I&&0!==I&&o.jsx("a",{href:P?`https://bgm.tv/subject/${I.toString()}`:`https://movie.douban.com/subject/${I.toString()}`,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"absolute top-2 left-2 opacity-0 -translate-x-2 transition-all duration-300 ease-in-out delay-100 group-hover:opacity-100 group-hover:translate-x-0",children:o.jsx("div",{className:"bg-green-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md hover:bg-green-600 hover:scale-[1.1] transition-all duration-300 ease-out",children:o.jsx(n.Z,{size:16})})}),E&&C&&C.length>0&&(()=>{let e=Array.from(new Set(C.map(e=>e.source_name))),t=e.length;return o.jsx("div",{className:"absolute bottom-2 right-2 opacity-0 transition-all duration-300 ease-in-out delay-75 group-hover:opacity-100",children:(0,o.jsxs)("div",{className:"relative group/sources",children:[o.jsx("div",{className:"bg-gray-700 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md hover:bg-gray-600 hover:scale-[1.1] transition-all duration-300 ease-out cursor-pointer",children:t}),(()=>{let t=["爱奇艺","腾讯视频","优酷","芒果TV","哔哩哔哩","Netflix","Disney+"],r=e.sort((e,r)=>{let o=t.indexOf(e),s=t.indexOf(r);return -1!==o&&-1!==s?o-s:-1!==o?-1:-1!==s?1:e.localeCompare(r)}),s=r.slice(0,6),a=r.length>6,i=r.length-6;return o.jsx("div",{className:"absolute bottom-full right-0 mb-2 opacity-0 invisible group-hover/sources:opacity-100 group-hover/sources:visible transition-all duration-200 ease-out delay-100 pointer-events-none z-50",children:(0,o.jsxs)("div",{className:"bg-gray-800/90 backdrop-blur-sm text-white text-xs rounded-lg shadow-xl border border-white/10 p-2 min-w-[120px] max-w-[200px]",children:[o.jsx("div",{className:"space-y-1",children:s.map((e,t)=>(0,o.jsxs)("div",{className:"flex items-center gap-1.5",children:[o.jsx("div",{className:"w-1 h-1 bg-blue-400 rounded-full flex-shrink-0"}),o.jsx("span",{className:"truncate text-xs",title:e,children:e})]},t))}),a&&o.jsx("div",{className:"mt-2 pt-1.5 border-t border-gray-700/50",children:o.jsx("div",{className:"flex items-center justify-center text-gray-400",children:(0,o.jsxs)("span",{className:"text-xs font-medium",children:["+",i," 播放源"]})})}),o.jsx("div",{className:"absolute top-full right-3 w-0 h-0 border-l-[6px] border-r-[6px] border-t-[6px] border-transparent border-t-gray-800/90"})]})})})()]})})})()]}),J.showProgress&&void 0!==v&&o.jsx("div",{className:"mt-1 h-1 w-full bg-gray-200 rounded-full overflow-hidden",children:o.jsx("div",{className:"h-full bg-green-500 transition-all duration-500 ease-out",style:{width:`${v}%`}})}),(0,o.jsxs)("div",{className:"mt-2 text-center",children:[(0,o.jsxs)("div",{className:"relative",children:[o.jsx("span",{className:"block text-sm font-semibold truncate text-gray-900 dark:text-gray-100 transition-colors duration-300 ease-in-out group-hover:text-green-600 dark:group-hover:text-green-400 peer",children:Z}),(0,o.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 invisible peer-hover:opacity-100 peer-hover:visible transition-all duration-200 ease-out delay-100 whitespace-nowrap pointer-events-none",children:[Z,o.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"})]})]}),J.showSourceName&&b&&o.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400 mt-1",children:o.jsx("span",{className:"inline-block border rounded px-2 py-0.5 border-gray-500/60 dark:border-gray-400/60 transition-all duration-300 ease-in-out group-hover:border-green-500/60 group-hover:text-green-600 dark:group-hover:text-green-400",children:b})})]})]})}}};