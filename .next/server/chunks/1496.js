"use strict";exports.id=1496,exports.ids=[1496],exports.modules={22106:(e,t,r)=>{r.d(t,{Z:()=>o});var s=r(19681);let o=({aspectRatio:e})=>s.jsx("div",{className:`w-full ${e} rounded-lg`,style:{background:"linear-gradient(90deg, var(--skeleton-color) 25%, var(--skeleton-highlight) 50%, var(--skeleton-color) 75%)",backgroundSize:"200% 100%",animation:"shine 1.5s infinite"},children:s.jsx("style",{children:`
      @keyframes shine {
        0% { background-position: -200% 0; }
        100% { background-position: 200% 0; }
      }
      
      /* 亮色模式变量 */
      :root {
        --skeleton-color: #f0f0f0;
        --skeleton-highlight: #e0e0e0;
      }
      
      /* 暗色模式变量 */
      @media (prefers-color-scheme: dark) {
        :root {
          --skeleton-color: #2d2d2d;
          --skeleton-highlight: #3d3d3d;
        }
      }
      
      .dark {
        --skeleton-color: #2d2d2d;
        --skeleton-highlight: #3d3d3d;
      }
    `})})},61496:(e,t,r)=>{r.d(t,{Z:()=>x});var s=r(19681),o=r(61824),a=r(46632),i=r(39190),l=r(29601),n=r(29872),d=r(18202),c=r(73301),h=r(73469),u=r(94434),p=r(22106);let m=(0,c.forwardRef)(function({id:e,title:t="",query:r="",poster:m="",episodes:x,source:g,source_name:b,source_names:w,progress:v=0,year:f,from:y,currentEpisode:k,douban_id:j,onDelete:N,rate:$,type:C="",isBangumi:P=!1,isAggregate:S=!1},R){let D=(0,d.useRouter)(),[z,E]=(0,c.useState)(!1),[H,L]=(0,c.useState)(!1),[Z,B]=(0,c.useState)(x),[I,U]=(0,c.useState)(w);(0,c.useEffect)(()=>{B(x)},[x]),(0,c.useEffect)(()=>{U(w)},[w]),(0,c.useImperativeHandle)(R,()=>({setEpisodes:e=>B(e),setSourceNames:e=>U(e)}));let Y=r||"",_=S?Z&&1===Z?"movie":"tv":C;(0,c.useEffect)(()=>{if("douban"===y||"search"===y||!g||!e)return;(async()=>{try{let t=await (0,h.at)(g,e);E(t)}catch(e){throw Error("检查收藏状态失败")}})();let t=(0,h.sO)(g,e);return(0,h.rq)("favoritesUpdated",e=>{E(!!e[t])})},[y,g,e]);let O=(0,c.useCallback)(async r=>{if(r.preventDefault(),r.stopPropagation(),"douban"!==y&&"search"!==y&&g&&e)try{z?(await (0,h.r7)(g,e),E(!1)):(await (0,h.qn)(g,e,{title:t,source_name:b||"",year:f||"",cover:m,total_episodes:Z??1,save_time:Date.now()}),E(!0))}catch(e){throw Error("切换收藏状态失败")}},[y,g,e,t,b,f,m,Z,z]),q=(0,c.useCallback)(async t=>{if(t.preventDefault(),t.stopPropagation(),"playrecord"===y&&g&&e)try{await (0,h.Ji)(g,e),N?.()}catch(e){throw Error("删除播放记录失败")}},[y,g,e,N]),T=(0,c.useCallback)(()=>{"douban"!==y&&(!S||g||e)?g&&e&&D.push(`/play?source=${g}&id=${e}&title=${encodeURIComponent(t)}${f?`&year=${f}`:""}${S?"&prefer=true":""}${Y?`&stitle=${encodeURIComponent(Y.trim())}`:""}${_?`&stype=${_}`:""}`):D.push(`/play?title=${encodeURIComponent(t.trim())}${f?`&year=${f}`:""}${_?`&stype=${_}`:""}${S?"&prefer=true":""}${Y?`&stitle=${encodeURIComponent(Y.trim())}`:""}`)},[y,g,e,D,t,f,S,Y,_]),A=(0,c.useMemo)(()=>{let e={playrecord:{showSourceName:!0,showProgress:!0,showPlayButton:!0,showHeart:!0,showCheckCircle:!0,showDoubanLink:!1,showRating:!1,showYear:!1},favorite:{showSourceName:!0,showProgress:!1,showPlayButton:!0,showHeart:!0,showCheckCircle:!1,showDoubanLink:!1,showRating:!1,showYear:!1},search:{showSourceName:!0,showProgress:!1,showPlayButton:!0,showHeart:!1,showCheckCircle:!1,showDoubanLink:!1,showRating:!1,showYear:!0},douban:{showSourceName:!1,showProgress:!1,showPlayButton:!0,showHeart:!1,showCheckCircle:!1,showDoubanLink:!0,showRating:!!$,showYear:!1}};return e[y]||e.search},[y,S,j,$]);return(0,s.jsxs)("div",{className:"group relative w-full rounded-lg bg-transparent cursor-pointer transition-all duration-300 ease-in-out hover:scale-[1.05] hover:z-[500]",onClick:T,children:[(0,s.jsxs)("div",{className:"relative aspect-[2/3] overflow-hidden rounded-lg",children:[!H&&s.jsx(p.Z,{aspectRatio:"aspect-[2/3]"}),s.jsx(n.default,{src:(0,u.a8)(m),alt:t,fill:!0,className:"object-cover",referrerPolicy:"no-referrer",loading:"lazy",onLoadingComplete:()=>L(!0),onError:e=>{let t=e.target;t.dataset.retried||(t.dataset.retried="true",setTimeout(()=>{t.src=(0,u.a8)(m)},2e3))}}),s.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent opacity-0 transition-opacity duration-300 ease-in-out group-hover:opacity-100"}),A.showPlayButton&&s.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 transition-all duration-300 ease-in-out delay-75 group-hover:opacity-100 group-hover:scale-100",children:s.jsx(o.Z,{size:50,strokeWidth:.8,className:"text-white fill-transparent transition-all duration-300 ease-out hover:fill-green-500 hover:scale-[1.1]"})}),(A.showHeart||A.showCheckCircle)&&(0,s.jsxs)("div",{className:"absolute bottom-3 right-3 flex gap-3 opacity-0 translate-y-2 transition-all duration-300 ease-in-out group-hover:opacity-100 group-hover:translate-y-0",children:[A.showCheckCircle&&s.jsx(a.Z,{onClick:q,size:20,className:"text-white transition-all duration-300 ease-out hover:stroke-red-500 hover:scale-[1.1]"}),A.showHeart&&s.jsx(i.Z,{onClick:O,size:20,className:`transition-all duration-300 ease-out ${z?"fill-red-600 stroke-red-600":"fill-transparent stroke-white hover:stroke-red-400"} hover:scale-[1.1]`})]}),A.showYear&&f&&"unknown"!==f&&""!==f.trim()&&s.jsx("div",{className:`absolute top-2 bg-black/50 text-white text-xs font-medium px-2 py-1 rounded backdrop-blur-sm shadow-sm transition-all duration-300 ease-out group-hover:opacity-90 ${A.showDoubanLink&&j&&0!==j?"left-2 group-hover:left-11":"left-2"}`,children:f}),A.showRating&&$&&s.jsx("div",{className:"absolute top-2 right-2 bg-pink-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md transition-all duration-300 ease-out group-hover:scale-110",children:$}),Z&&Z>1&&s.jsx("div",{className:"absolute top-2 right-2 bg-green-500 text-white text-xs font-semibold px-2 py-1 rounded-md shadow-md transition-all duration-300 ease-out group-hover:scale-110",children:k?`${k}/${Z}`:Z}),A.showDoubanLink&&j&&0!==j&&s.jsx("a",{href:P?`https://bgm.tv/subject/${j.toString()}`:`https://movie.douban.com/subject/${j.toString()}`,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"absolute top-2 left-2 opacity-0 -translate-x-2 transition-all duration-300 ease-in-out delay-100 group-hover:opacity-100 group-hover:translate-x-0",children:s.jsx("div",{className:"bg-green-500 text-white text-xs font-bold w-7 h-7 rounded-full flex items-center justify-center shadow-md hover:bg-green-600 hover:scale-[1.1] transition-all duration-300 ease-out",children:s.jsx(l.Z,{size:16})})}),S&&I&&I.length>0&&(()=>{let e=Array.from(new Set(I)),t=e.length;return s.jsx("div",{className:"absolute bottom-2 right-2 opacity-0 transition-all duration-300 ease-in-out delay-75 group-hover:opacity-100",children:(0,s.jsxs)("div",{className:"relative group/sources",children:[s.jsx("div",{className:"bg-gray-700 text-white text-xs font-bold w-6 h-6 sm:w-7 sm:h-7 rounded-full flex items-center justify-center shadow-md hover:bg-gray-600 hover:scale-[1.1] transition-all duration-300 ease-out cursor-pointer",children:t}),(()=>{let t=["爱奇艺","腾讯视频","优酷","芒果TV","哔哩哔哩","Netflix","Disney+"],r=e.sort((e,r)=>{let s=t.indexOf(e),o=t.indexOf(r);return -1!==s&&-1!==o?s-o:-1!==s?-1:-1!==o?1:e.localeCompare(r)}),o=r.slice(0,6),a=r.length>6,i=r.length-6;return s.jsx("div",{className:"absolute bottom-full mb-2 opacity-0 invisible group-hover/sources:opacity-100 group-hover/sources:visible transition-all duration-200 ease-out delay-100 pointer-events-none z-50 right-0 sm:right-0 -translate-x-0 sm:translate-x-0",children:(0,s.jsxs)("div",{className:"bg-gray-800/90 backdrop-blur-sm text-white text-xs sm:text-xs rounded-lg shadow-xl border border-white/10 p-1.5 sm:p-2 min-w-[100px] sm:min-w-[120px] max-w-[140px] sm:max-w-[200px] overflow-hidden",children:[s.jsx("div",{className:"space-y-0.5 sm:space-y-1",children:o.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-1 sm:gap-1.5",children:[s.jsx("div",{className:"w-0.5 h-0.5 sm:w-1 sm:h-1 bg-blue-400 rounded-full flex-shrink-0"}),s.jsx("span",{className:"truncate text-[10px] sm:text-xs leading-tight",title:e,children:e})]},t))}),a&&s.jsx("div",{className:"mt-1 sm:mt-2 pt-1 sm:pt-1.5 border-t border-gray-700/50",children:s.jsx("div",{className:"flex items-center justify-center text-gray-400",children:(0,s.jsxs)("span",{className:"text-[10px] sm:text-xs font-medium",children:["+",i," 播放源"]})})}),s.jsx("div",{className:"absolute top-full right-2 sm:right-3 w-0 h-0 border-l-[4px] border-r-[4px] border-t-[4px] sm:border-l-[6px] sm:border-r-[6px] sm:border-t-[6px] border-transparent border-t-gray-800/90"})]})})})()]})})})()]}),A.showProgress&&void 0!==v&&s.jsx("div",{className:"mt-1 h-1 w-full bg-gray-200 rounded-full overflow-hidden",children:s.jsx("div",{className:"h-full bg-green-500 transition-all duration-500 ease-out",style:{width:`${v}%`}})}),(0,s.jsxs)("div",{className:"mt-2 text-center",children:[(0,s.jsxs)("div",{className:"relative",children:[s.jsx("span",{className:"block text-sm font-semibold truncate text-gray-900 dark:text-gray-100 transition-colors duration-300 ease-in-out group-hover:text-green-600 dark:group-hover:text-green-400 peer",children:t}),(0,s.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-800 text-white text-xs rounded-md shadow-lg opacity-0 invisible peer-hover:opacity-100 peer-hover:visible transition-all duration-200 ease-out delay-100 whitespace-nowrap pointer-events-none",children:[t,s.jsx("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-800"})]})]}),A.showSourceName&&b&&s.jsx("span",{className:"block text-xs text-gray-500 dark:text-gray-400 mt-1",children:s.jsx("span",{className:"inline-block border rounded px-2 py-0.5 border-gray-500/60 dark:border-gray-400/60 transition-all duration-300 ease-in-out group-hover:border-green-500/60 group-hover:text-green-600 dark:group-hover:text-green-400",children:b})})]})]})}),x=(0,c.memo)(m)}};