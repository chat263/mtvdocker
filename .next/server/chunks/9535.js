exports.id=9535,exports.ids=[9535],exports.modules={52234:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,19400,23)),Promise.resolve().then(r.t.bind(r,74837,23)),Promise.resolve().then(r.t.bind(r,34382,23)),Promise.resolve().then(r.t.bind(r,39636,23)),Promise.resolve().then(r.t.bind(r,53572,23)),Promise.resolve().then(r.t.bind(r,14304,23))},15622:(e,t,r)=>{Promise.resolve().then(r.bind(r,76563)),Promise.resolve().then(r.bind(r,72687)),Promise.resolve().then(r.bind(r,9552))},76563:(e,t,r)=>{"use strict";r.d(t,{GlobalErrorIndicator:()=>i});var n=r(19681),a=r(73301);function i(){let[e,t]=(0,a.useState)(null),[r,i]=(0,a.useState)(!1),[o,s]=(0,a.useState)(!1);return r&&e?n.jsx("div",{className:"fixed top-4 right-4 z-[2000]",children:(0,n.jsxs)("div",{className:`bg-red-500 text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between min-w-[300px] max-w-[400px] transition-all duration-300 ${o?"scale-105 bg-red-400":"scale-100 bg-red-500"} animate-fade-in`,children:[n.jsx("span",{className:"text-sm font-medium flex-1 mr-3",children:e.message}),n.jsx("button",{onClick:()=>{i(!1),t(null),s(!1)},className:"text-white hover:text-red-100 transition-colors flex-shrink-0","aria-label":"关闭错误提示",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):null}},72687:(e,t,r)=>{"use strict";r.d(t,{SiteProvider:()=>s,W:()=>o});var n=r(19681),a=r(73301);let i=(0,a.createContext)({siteName:"MoonTV",announcement:"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。"}),o=()=>(0,a.useContext)(i);function s({children:e,siteName:t,announcement:r}){return n.jsx(i.Provider,{value:{siteName:t,announcement:r},children:e})}},9552:(e,t,r)=>{"use strict";r.d(t,{ThemeProvider:()=>i});var n=r(19681),a=r(66081);function i({children:e,...t}){return n.jsx(a.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,...t,children:e})}r(73301)},97214:(e,t,r)=>{"use strict";r.d(t,{T:()=>l});var n=r(19681),a=r(78747),i=r(80606),o=r(18202),s=r(66081),c=r(73301);function l(){let[e,t]=(0,c.useState)(!1),{setTheme:r,resolvedTheme:l}=(0,s.F)();(0,o.usePathname)();let u=e=>{let t=document.querySelector('meta[name="theme-color"]');if(t)t.setAttribute("content","dark"===e?"#0c111c":"#f9fbfe");else{let t=document.createElement("meta");t.name="theme-color",t.content="dark"===e?"#0c111c":"#f9fbfe",document.head.appendChild(t)}};return e?n.jsx("button",{onClick:()=>{let e="dark"===l?"light":"dark";if(u(e),!document.startViewTransition){r(e);return}document.startViewTransition(()=>{r(e)})},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Toggle theme",children:"dark"===l?n.jsx(a.Z,{className:"w-full h-full"}):n.jsx(i.Z,{className:"w-full h-full"})}):n.jsx("div",{className:"w-10 h-10"})}},46768:(e,t,r)=>{"use strict";r.d(t,{w:()=>n});let n="2.3.0"},30045:(e,t,r)=>{"use strict";r.d(t,{Df:()=>i,n4:()=>s,qu:()=>n});var n,a=r(46768);async function i(){try{let e=await o("https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/VERSION.txt");if(e)return s(e);let t=await o(["https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/VERSION.txt"][1]);if(t)return s(t);return"fetch_failed"}catch(e){return console.error("版本检查失败:",e),"fetch_failed"}}async function o(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),n=Date.now(),a=e.includes("?")?`${e}&_t=${n}`:`${e}?_t=${n}`,i=await fetch(a,{method:"GET",signal:t.signal,headers:{"Content-Type":"text/plain"}});if(clearTimeout(r),!i.ok)throw Error(`HTTP error! status: ${i.status}`);return(await i.text()).trim()}catch(t){return console.warn(`从 ${e} 获取版本信息失败:`,t),null}}function s(e){if(e===a.w)return"no_update";try{let t=a.w.split(".").map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0)throw Error(`无效的版本号格式: ${a.w}`);return t}),r=e.split(".").map(t=>{let r=parseInt(t,10);if(isNaN(r)||r<0)throw Error(`无效的版本号格式: ${e}`);return r}),n=e=>{if(e.length>=3)return e.slice(0,3);{let t=[...e];for(;t.length<3;)t.push(0);return t}},i=n(t),o=n(r);for(let e=0;e<3;e++){if(o[e]>i[e])return"has_update";if(o[e]<i[e])break}return"no_update"}catch(t){return console.error("版本号比较失败:",t),e!==a.w?"has_update":"no_update"}}!function(e){e.HAS_UPDATE="has_update",e.NO_UPDATE="no_update",e.FETCH_FAILED="fetch_failed"}(n||(n={}))},83421:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f,dynamic:()=>d,generateMetadata:()=>m,viewport:()=>p});var n=r(43844),a=r(39514),i=r.n(a);r(75552),r(40516);var o=r(13303),s=r(15761);let c=(0,s.createProxy)(String.raw`/app/src/components/GlobalErrorIndicator.tsx#GlobalErrorIndicator`);(0,s.createProxy)(String.raw`/app/src/components/GlobalErrorIndicator.tsx#triggerGlobalError`),(0,s.createProxy)(String.raw`/app/src/components/SiteProvider.tsx#useSite`);let l=(0,s.createProxy)(String.raw`/app/src/components/SiteProvider.tsx#SiteProvider`),u=(0,s.createProxy)(String.raw`/app/src/components/ThemeProvider.tsx#ThemeProvider`),d="force-dynamic";async function m(){let e=process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",t=await (0,o.iE)(),r=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV";return"localstorage"!==e&&(r=t.SiteConfig.SiteName),{title:r,description:"影视聚合",manifest:"/manifest.json"}}let p={viewportFit:"cover"};async function f({children:e}){let t=process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",r=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV",a=process.env.ANNOUNCEMENT||"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。",s="true"===process.env.NEXT_PUBLIC_ENABLE_REGISTER,d=process.env.NEXT_PUBLIC_DOUBAN_PROXY_TYPE||"direct",m=process.env.NEXT_PUBLIC_DOUBAN_PROXY||"",p=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY_TYPE||"direct",f=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY||"",h="true"===process.env.NEXT_PUBLIC_DISABLE_YELLOW_FILTER,g=[];if("localstorage"!==t){let e=await (0,o.iE)();r=e.SiteConfig.SiteName,a=e.SiteConfig.Announcement,s=e.UserConfig.AllowRegister,d=e.SiteConfig.DoubanProxyType,m=e.SiteConfig.DoubanProxy,p=e.SiteConfig.DoubanImageProxyType,f=e.SiteConfig.DoubanImageProxy,h=e.SiteConfig.DisableYellowFilter,g=e.CustomCategories.filter(e=>!e.disabled).map(e=>({name:e.name||"",type:e.type,query:e.query}))}let E={STORAGE_TYPE:process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",ENABLE_REGISTER:s,DOUBAN_PROXY_TYPE:d,DOUBAN_PROXY:m,DOUBAN_IMAGE_PROXY_TYPE:p,DOUBAN_IMAGE_PROXY:f,DISABLE_YELLOW_FILTER:h,CUSTOM_CATEGORIES:g};return(0,n.jsxs)("html",{lang:"zh-CN",suppressHydrationWarning:!0,children:[(0,n.jsxs)("head",{children:[n.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, viewport-fit=cover"}),n.jsx("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png"}),n.jsx("script",{dangerouslySetInnerHTML:{__html:`window.RUNTIME_CONFIG = ${JSON.stringify(E)};`}})]}),n.jsx("body",{className:`${i().className} min-h-screen bg-white text-gray-900 dark:bg-black dark:text-gray-200`,children:n.jsx(u,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,n.jsxs)(l,{siteName:r,announcement:a,children:[e,n.jsx(c,{})]})})})]})}},13303:(e,t,r)=>{"use strict";let n;r.d(t,{Hz:()=>i,Ih:()=>l,iE:()=>c,jT:()=>u,ll:()=>d,mL:()=>o});var a=r(35737);let i={search:{path:"?ac=videolist&wd=",pagePath:"?ac=videolist&wd={query}&pg={page}",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json"}},detail:{path:"?ac=videolist&ids=",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json"}}};function o(e){let t;try{t=JSON.parse(e.ConfigFile)}catch(e){t={}}let r=Object.entries(t.api_site||[]),n=new Map((e.SourceConfig||[]).map(e=>[e.key,e]));r.forEach(([e,t])=>{let r=n.get(e);r?(r.name=t.name,r.api=t.api,r.detail=t.detail,r.from="config"):n.set(e,{key:e,name:t.name,api:t.api,detail:t.detail,from:"config",disabled:!1})});let a=new Set(r.map(([e])=>e));n.forEach(e=>{a.has(e.key)||(e.from="custom")}),e.SourceConfig=Array.from(n.values());let i=t.custom_category||[],o=new Map((e.CustomCategories||[]).map(e=>[e.query+e.type,e]));i.forEach(e=>{let t=e.query+e.type,r=o.get(t);r?(r.name=e.name,r.query=e.query,r.type=e.type,r.from="config"):o.set(t,{name:e.name,type:e.type,query:e.query,from:"config",disabled:!1})});let s=new Set(i.map(e=>e.query+e.type));return o.forEach(e=>{s.has(e.query+e.type)||(e.from="custom")}),e.CustomCategories=Array.from(o.values()),e}async function s(e,t={URL:"",AutoUpdate:!1,LastCheck:""}){let r;try{r=JSON.parse(e)}catch(e){r={}}let n={ConfigFile:e,ConfigSubscribtion:t,SiteConfig:{SiteName:process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV",Announcement:process.env.ANNOUNCEMENT||"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。",SearchDownstreamMaxPage:Number(process.env.NEXT_PUBLIC_SEARCH_MAX_PAGE)||5,SiteInterfaceCacheTime:r.cache_time||7200,DoubanProxyType:process.env.NEXT_PUBLIC_DOUBAN_PROXY_TYPE||"direct",DoubanProxy:process.env.NEXT_PUBLIC_DOUBAN_PROXY||"",DoubanImageProxyType:process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY_TYPE||"direct",DoubanImageProxy:process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY||"",DisableYellowFilter:"true"===process.env.NEXT_PUBLIC_DISABLE_YELLOW_FILTER},UserConfig:{AllowRegister:"true"===process.env.NEXT_PUBLIC_ENABLE_REGISTER,Users:[]},SourceConfig:[],CustomCategories:[]},i=(0,a.cF)(),o=[];if(i&&"function"==typeof i.getAllUsers)try{o=await i.getAllUsers()}catch(e){console.error("获取用户列表失败:",e)}let s=o.filter(e=>e!==process.env.USERNAME).map(e=>({username:e,role:"user",banned:!1}));return s.unshift({username:process.env.USERNAME,role:"owner",banned:!1}),n.UserConfig.Users=s,Object.entries(r.api_site||[]).forEach(([e,t])=>{n.SourceConfig.push({key:e,name:t.name,api:t.api,detail:t.detail,from:"config",disabled:!1})}),r.custom_category?.forEach(e=>{n.CustomCategories.push({name:e.name||e.query,type:e.type,query:e.query,from:"config",disabled:!1})}),n}async function c(){if(n)return n;let e=(0,a.cF)(),t=null;return e&&"function"==typeof e.getAdminConfig&&(t=await e.getAdminConfig()),t||(t=await s("")),n=t}async function l(){let e;let t=(0,a.cF)();e=t&&"function"==typeof t.getAdminConfig?await t.getAdminConfig():{};let r=await s(e.ConfigFile,e.ConfigSubscribtion);n=r,t&&"function"==typeof t.setAdminConfig&&await t.setAdminConfig(r)}async function u(){return(await c()).SiteConfig.SiteInterfaceCacheTime||7200}async function d(){return(await c()).SourceConfig.filter(e=>!e.disabled).map(e=>({key:e.key,name:e.name,api:e.api,detail:e.detail}))}},75552:()=>{}};