exports.id=2957,exports.ids=[2957],exports.modules={52234:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,19400,23)),Promise.resolve().then(t.t.bind(t,74837,23)),Promise.resolve().then(t.t.bind(t,34382,23)),Promise.resolve().then(t.t.bind(t,39636,23)),Promise.resolve().then(t.t.bind(t,53572,23)),Promise.resolve().then(t.t.bind(t,14304,23))},15622:(e,r,t)=>{Promise.resolve().then(t.bind(t,76563)),Promise.resolve().then(t.bind(t,72687)),Promise.resolve().then(t.bind(t,9552))},76563:(e,r,t)=>{"use strict";t.d(r,{GlobalErrorIndicator:()=>s});var n=t(19681),o=t(73301);function s(){let[e,r]=(0,o.useState)(null),[t,s]=(0,o.useState)(!1),[i,a]=(0,o.useState)(!1);return t&&e?n.jsx("div",{className:"fixed top-4 right-4 z-[2000]",children:(0,n.jsxs)("div",{className:`bg-red-500 text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between min-w-[300px] max-w-[400px] transition-all duration-300 ${i?"scale-105 bg-red-400":"scale-100 bg-red-500"} animate-fade-in`,children:[n.jsx("span",{className:"text-sm font-medium flex-1 mr-3",children:e.message}),n.jsx("button",{onClick:()=>{s(!1),r(null),a(!1)},className:"text-white hover:text-red-100 transition-colors flex-shrink-0","aria-label":"关闭错误提示",children:n.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):null}},72687:(e,r,t)=>{"use strict";t.d(r,{SiteProvider:()=>a,W:()=>i});var n=t(19681),o=t(73301);let s=(0,o.createContext)({siteName:"MoonTV",announcement:"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。"}),i=()=>(0,o.useContext)(s);function a({children:e,siteName:r,announcement:t}){return n.jsx(s.Provider,{value:{siteName:r,announcement:t},children:e})}},9552:(e,r,t)=>{"use strict";t.d(r,{ThemeProvider:()=>s});var n=t(19681),o=t(66081);function s({children:e,...r}){return n.jsx(o.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,...r,children:e})}t(73301)},83421:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>f,dynamic:()=>u,generateMetadata:()=>m,viewport:()=>p});var n=t(43844),o=t(39514),s=t.n(o);t(75552),t(40516);var i=t(13303),a=t(15761);let c=(0,a.createProxy)(String.raw`/app/src/components/GlobalErrorIndicator.tsx#GlobalErrorIndicator`);(0,a.createProxy)(String.raw`/app/src/components/GlobalErrorIndicator.tsx#triggerGlobalError`),(0,a.createProxy)(String.raw`/app/src/components/SiteProvider.tsx#useSite`);let l=(0,a.createProxy)(String.raw`/app/src/components/SiteProvider.tsx#SiteProvider`),d=(0,a.createProxy)(String.raw`/app/src/components/ThemeProvider.tsx#ThemeProvider`),u="force-dynamic";async function m(){let e=process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",r=await (0,i.iE)(),t=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV";return"localstorage"!==e&&(t=r.SiteConfig.SiteName),{title:t,description:"影视聚合",manifest:"/manifest.json"}}let p={viewportFit:"cover"};async function f({children:e}){let r=process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",t=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV",o=process.env.ANNOUNCEMENT||"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。",a="true"===process.env.NEXT_PUBLIC_ENABLE_REGISTER,u=process.env.NEXT_PUBLIC_DOUBAN_PROXY_TYPE||"melody-cdn-sharon",m=process.env.NEXT_PUBLIC_DOUBAN_PROXY||"",p=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY_TYPE||"melody-cdn-sharon",f=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY||"",g="true"===process.env.NEXT_PUBLIC_DISABLE_YELLOW_FILTER,C="false"!==process.env.NEXT_PUBLIC_FLUID_SEARCH,E=[];if("localstorage"!==r){let e=await (0,i.iE)();t=e.SiteConfig.SiteName,o=e.SiteConfig.Announcement,a=e.UserConfig.AllowRegister,u=e.SiteConfig.DoubanProxyType,m=e.SiteConfig.DoubanProxy,p=e.SiteConfig.DoubanImageProxyType,f=e.SiteConfig.DoubanImageProxy,g=e.SiteConfig.DisableYellowFilter,E=e.CustomCategories.filter(e=>!e.disabled).map(e=>({name:e.name||"",type:e.type,query:e.query})),C=e.SiteConfig.FluidSearch}let y={STORAGE_TYPE:process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",ENABLE_REGISTER:a,DOUBAN_PROXY_TYPE:u,DOUBAN_PROXY:m,DOUBAN_IMAGE_PROXY_TYPE:p,DOUBAN_IMAGE_PROXY:f,DISABLE_YELLOW_FILTER:g,CUSTOM_CATEGORIES:E,FLUID_SEARCH:C};return(0,n.jsxs)("html",{lang:"zh-CN",suppressHydrationWarning:!0,children:[(0,n.jsxs)("head",{children:[n.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, viewport-fit=cover"}),n.jsx("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png"}),n.jsx("script",{dangerouslySetInnerHTML:{__html:`window.RUNTIME_CONFIG = ${JSON.stringify(y)};`}})]}),n.jsx("body",{className:`${s().className} min-h-screen bg-white text-gray-900 dark:bg-black dark:text-gray-200`,children:n.jsx(d,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,n.jsxs)(l,{siteName:t,announcement:o,children:[e,n.jsx(c,{})]})})})]})}},13303:(e,r,t)=>{"use strict";let n;t.d(r,{Hz:()=>s,Ih:()=>d,iE:()=>c,jT:()=>u,ll:()=>m,mL:()=>i,xg:()=>l,yT:()=>p});var o=t(97690);let s={search:{path:"?ac=videolist&wd=",pagePath:"?ac=videolist&wd={query}&pg={page}",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json"}},detail:{path:"?ac=videolist&ids=",headers:{"User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36",Accept:"application/json"}}};function i(e){let r;try{r=JSON.parse(e.ConfigFile)}catch(e){r={}}let t=Object.entries(r.api_site||[]),n=new Map((e.SourceConfig||[]).map(e=>[e.key,e]));t.forEach(([e,r])=>{let t=n.get(e);t?(t.name=r.name,t.api=r.api,t.detail=r.detail,t.from="config"):n.set(e,{key:e,name:r.name,api:r.api,detail:r.detail,from:"config",disabled:!1})});let o=new Set(t.map(([e])=>e));n.forEach(e=>{o.has(e.key)||(e.from="custom")}),e.SourceConfig=Array.from(n.values());let s=r.custom_category||[],i=new Map((e.CustomCategories||[]).map(e=>[e.query+e.type,e]));s.forEach(e=>{let r=e.query+e.type,t=i.get(r);t?(t.name=e.name,t.query=e.query,t.type=e.type,t.from="config"):i.set(r,{name:e.name,type:e.type,query:e.query,from:"config",disabled:!1})});let a=new Set(s.map(e=>e.query+e.type));return i.forEach(e=>{a.has(e.query+e.type)||(e.from="custom")}),e.CustomCategories=Array.from(i.values()),e}async function a(e,r={URL:"",AutoUpdate:!1,LastCheck:""}){let t;try{t=JSON.parse(e)}catch(e){t={}}let n={ConfigFile:e,ConfigSubscribtion:r,SiteConfig:{SiteName:process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV",Announcement:process.env.ANNOUNCEMENT||"本网站仅提供影视信息搜索服务，所有内容均来自第三方网站。本站不存储任何视频资源，不对任何内容的准确性、合法性、完整性负责。",SearchDownstreamMaxPage:Number(process.env.NEXT_PUBLIC_SEARCH_MAX_PAGE)||5,SiteInterfaceCacheTime:t.cache_time||7200,DoubanProxyType:process.env.NEXT_PUBLIC_DOUBAN_PROXY_TYPE||"melody-cdn-sharon",DoubanProxy:process.env.NEXT_PUBLIC_DOUBAN_PROXY||"",DoubanImageProxyType:process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY_TYPE||"melody-cdn-sharon",DoubanImageProxy:process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY||"",DisableYellowFilter:"true"===process.env.NEXT_PUBLIC_DISABLE_YELLOW_FILTER,FluidSearch:"false"!==process.env.NEXT_PUBLIC_FLUID_SEARCH},UserConfig:{AllowRegister:"true"===process.env.NEXT_PUBLIC_ENABLE_REGISTER,Users:[]},SourceConfig:[],CustomCategories:[]},s=[];try{s=await o.db.getAllUsers()}catch(e){console.error("获取用户列表失败:",e)}let i=s.filter(e=>e!==process.env.USERNAME).map(e=>({username:e,role:"user",banned:!1}));return i.unshift({username:process.env.USERNAME,role:"owner",banned:!1}),n.UserConfig.Users=i,Object.entries(t.api_site||[]).forEach(([e,r])=>{n.SourceConfig.push({key:e,name:r.name,api:r.api,detail:r.detail,from:"config",disabled:!1})}),t.custom_category?.forEach(e=>{n.CustomCategories.push({name:e.name||e.query,type:e.type,query:e.query,from:"config",disabled:!1})}),n}async function c(){if(n)return n;let e=null;try{e=await o.db.getAdminConfig()}catch(e){console.error("获取管理员配置失败:",e)}return e||(e=await a("")),n=e=l(e),o.db.saveAdminConfig(n),n}function l(e){e.UserConfig||(e.UserConfig={AllowRegister:!1,Users:[]}),e.UserConfig.Users&&Array.isArray(e.UserConfig.Users)||(e.UserConfig.Users=[]),e.SourceConfig&&Array.isArray(e.SourceConfig)||(e.SourceConfig=[]),e.CustomCategories&&Array.isArray(e.CustomCategories)||(e.CustomCategories=[]);let r=process.env.USERNAME,t=new Set;e.UserConfig.Users=e.UserConfig.Users.filter(e=>!t.has(e.username)&&(t.add(e.username),!0)),e.UserConfig.Users=e.UserConfig.Users.filter(e=>e.username!==r),e.UserConfig.Users.forEach(e=>{"owner"===e.role&&(e.role="user")}),e.UserConfig.Users.unshift({username:r,role:"owner",banned:!1});let n=new Set;e.SourceConfig=e.SourceConfig.filter(e=>!n.has(e.key)&&(n.add(e.key),!0));let o=new Set;return e.CustomCategories=e.CustomCategories.filter(e=>!o.has(e.query+e.type)&&(o.add(e.query+e.type),!0)),e}async function d(){let e=null;try{e=await o.db.getAdminConfig()}catch(e){console.error("获取管理员配置失败:",e)}e||(e={});let r=await a(e.ConfigFile,e.ConfigSubscribtion);n=r,await o.db.saveAdminConfig(r)}async function u(){return(await c()).SiteConfig.SiteInterfaceCacheTime||7200}async function m(){return(await c()).SourceConfig.filter(e=>!e.disabled).map(e=>({key:e.key,name:e.name,api:e.api,detail:e.detail}))}async function p(e){n=e}},75552:()=>{}};