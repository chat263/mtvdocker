"use strict";exports.id=8300,exports.ids=[8300],exports.modules={73953:(e,t,a)=>{a.d(t,{Z:()=>H});var r=a(19681),s=a(46127);function l(){return r.jsx("button",{onClick:()=>window.history.back(),className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Back",children:r.jsx(s.Z,{className:"w-full h-full"})})}var d=a(12196),n=a(76625),i=a(72295),o=a(17147),c=a(56611),x=a(1887),m=a(53892),g=a(30657),h=a(18202),u=a(73301);let y=({activePath:e})=>{let t=(0,h.usePathname)(),a=e??t,[s,l]=(0,u.useState)([{icon:d.Z,label:"首页",href:"/"},{icon:n.Z,label:"搜索",href:"/search"},{icon:i.Z,label:"电影",href:"/douban?type=movie"},{icon:o.Z,label:"剧集",href:"/douban?type=tv"},{icon:c.Z,label:"动漫",href:"/douban?type=anime"},{icon:x.Z,label:"综艺",href:"/douban?type=show"}]);(0,u.useEffect)(()=>{let e=window.RUNTIME_CONFIG;e?.CUSTOM_CATEGORIES?.length>0&&l(e=>[...e,{icon:m.Z,label:"自定义",href:"/douban?type=custom"}])},[]);let y=e=>{let t=e.match(/type=([^&]+)/)?.[1],r=decodeURIComponent(a);return r===decodeURIComponent(e)||r.startsWith("/douban")&&r.includes(`type=${t}`)};return r.jsx("nav",{className:"md:hidden fixed left-0 right-0 z-[600] bg-white/90 backdrop-blur-xl border-t border-gray-200/50 overflow-hidden dark:bg-gray-900/80 dark:border-gray-700/50",style:{bottom:0,paddingBottom:"env(safe-area-inset-bottom)",minHeight:"calc(3.5rem + env(safe-area-inset-bottom))"},children:r.jsx("ul",{className:"flex items-center overflow-x-auto scrollbar-hide",children:s.map(e=>{let t=y(e.href);return r.jsx("li",{className:"flex-shrink-0",style:{width:"20vw",minWidth:"20vw"},children:(0,r.jsxs)(g.default,{href:e.href,className:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",children:[r.jsx(e.icon,{className:`h-6 w-6 ${t?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"}`}),r.jsx("span",{className:t?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300",children:e.label})]})},e.href)})})})};var b=a(72687),f=a(97214),p=a(1239),j=a(49432),v=a(19556),k=a(68766),w=a(35128),N=a(80690),C=a(4540),S=a(53558),Z=a(86294),E=a(15501),T=a(46768),O=a(30045),_=a(36915),I=a(48935),P=a(83042),A=a(35938),U=a(17155),L=a(30648);let R=[{version:"2.3.0",date:"2025-08-15",added:["支持站长导入导出整站数据"],changed:["仅允许站长操作配置文件","微调搜索结果过滤面板的移动端样式"],fixed:[]},{version:"2.2.1",date:"2025-08-14",added:[],changed:[],fixed:["修复了筛选 panel 打开时滚动页面 panel 不跟随的问题"]},{version:"2.2.0",date:"2025-08-14",added:["搜索结果支持按播放源、标题和年份筛选，支持按年份排序","搜索界面视频卡片展示年份信息，聚合卡片展示播放源"],changed:[],fixed:["修复 /api/search/resources 返回空的问题","修复 upstash 实例无法编辑自定义分类的问题"]},{version:"2.1.0",date:"2025-08-13",added:["支持通过订阅获取配置文件"],changed:["微调部分文案和 UI","删除部分无用代码"],fixed:[]},{version:"2.0.1",date:"2025-08-13",added:[],changed:["版本检查和变更日志请求 Github"],fixed:["微调管理面板样式"]},{version:"2.0.0",date:"2025-08-13",added:["支持配置文件在线配置和编辑","搜索页搜索框实时联想","去除对 localstorage 模式的支持"],changed:["播放记录删除按钮改为垃圾桶图标以消除歧义"],fixed:["限制设置面板的最大长度，防止超出视口"]},{version:"1.1.1",date:"2025-08-12",added:[],changed:["修正 zwei 提供的 cors proxy 地址","移除废弃代码"],fixed:["[运维] docker workflow release 日期使用东八区日期"]},{version:"1.1.0",date:"2025-08-12",added:["每日新番放送功能，展示每日新番放送的番剧"],changed:[],fixed:["修复远程 CHANGELOG 无法提取变更内容的问题"]},{version:"1.0.5",date:"2025-08-12",added:[],changed:["实现基于 Git 标签的自动 Release 工作流"],fixed:[]},{version:"1.0.4",date:"2025-08-11",added:["优化版本管理工作流，实现单点修改"],changed:["版本号现在从 CHANGELOG 自动提取，无需手动维护 VERSION.txt"],fixed:[]},{version:"1.0.3",date:"2025-08-11",added:[],changed:["升级播放器 Artplayer 至版本 5.2.5"],fixed:[]},{version:"1.0.2",date:"2025-08-11",added:[],changed:["版本号比较机制恢复为数字比较，仅当最新版本大于本地版本时才认为有更新","[运维] 自动替换 version.ts 中的版本号为 VERSION.txt 中的版本号"],fixed:[]},{version:"1.0.1",date:"2025-08-11",added:[],changed:[],fixed:["修复版本检查功能，只要与最新版本号不一致即认为有更新"]},{version:"1.0.0",date:"2025-08-10",added:["基于 Semantic Versioning 的版本号机制","版本信息面板，展示本地变更日志和远程更新日志"],changed:[],fixed:[]}],$=({isOpen:e,onClose:t})=>{let[a,s]=(0,u.useState)(!1),[l,d]=(0,u.useState)([]),[n,i]=(0,u.useState)(!1),[o,c]=(0,u.useState)(""),[x,m]=(0,u.useState)(!1);(0,u.useEffect)(()=>(s(!0),()=>s(!1)),[]),(0,u.useEffect)(()=>{e&&g()},[e]);let g=async()=>{try{let e=await fetch("https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/CHANGELOG");if(e.ok){let t=await e.text(),a=h(t);if(d(a),a.length>0){let e=a[0];c(e.version),i((0,O.n4)(e.version)===O.qu.HAS_UPDATE)}}else console.error("获取远程变更日志失败:",e.status,e.statusText)}catch(e){console.error("获取远程变更日志失败:",e)}},h=e=>{let t=e.split("\n"),a=[],r=null,s=null,l=!1;for(let e of t){let t=e.trim(),d=t.match(/^## \[([\d.]+)\] - (\d{4}-\d{2}-\d{2})$/);if(d){r&&a.push(r),r={version:d[1],date:d[2],added:[],changed:[],fixed:[]},s=null,l=!0;continue}if(l&&r){if("### Added"===t){s="added";continue}if("### Changed"===t){s="changed";continue}if("### Fixed"===t){s="fixed";continue}if(t.startsWith("- ")&&s){let e=t.substring(2);"added"===s?r.added.push(e):"changed"===s?r.changed.push(e):"fixed"===s&&r.fixed.push(e)}}}return r&&a.push(r),a},y=(e,t=!1,a=!1)=>{let s=a&&n&&e.version===o;return(0,r.jsxs)("div",{className:`p-4 rounded-lg border ${t?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":s?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-gray-50 dark:bg-gray-800/60 border-gray-200 dark:border-gray-700"}`,children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["v",e.version]}),t&&r.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 rounded-full",children:"当前版本"}),s&&(0,r.jsxs)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:[r.jsx(_.Z,{className:"w-3 h-3"}),"可更新"]})]}),r.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:e.date})]}),(0,r.jsxs)("div",{className:"space-y-3",children:[e.added.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-green-700 dark:text-green-400 mb-2 flex items-center gap-1",children:[r.jsx(I.Z,{className:"w-4 h-4"}),"新增功能"]}),r.jsx("ul",{className:"space-y-1",children:e.added.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e]},t))})]}),e.changed.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-400 mb-2 flex items-center gap-1",children:[r.jsx(P.Z,{className:"w-4 h-4"}),"功能改进"]}),r.jsx("ul",{className:"space-y-1",children:e.changed.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e]},t))})]}),e.fixed.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-400 mb-2 flex items-center gap-1",children:[r.jsx(A.Z,{className:"w-4 h-4"}),"问题修复"]}),r.jsx("ul",{className:"space-y-1",children:e.fixed.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),e]},t))})]})]})]},e.version)},b=(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:t}),(0,r.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-xl max-h-[90vh] bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] overflow-hidden",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 dark:text-gray-200",children:"版本信息"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[(0,r.jsxs)("span",{className:"px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-full",children:["v",T.w]}),n&&(0,r.jsxs)("span",{className:"px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:[r.jsx(_.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),r.jsx("span",{className:"hidden sm:inline",children:"有新版本可用"}),r.jsx("span",{className:"sm:hidden",children:"可更新"})]})]})]}),r.jsx("button",{onClick:t,className:"w-6 h-6 sm:w-8 sm:h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"关闭",children:r.jsx(w.Z,{className:"w-full h-full"})})]}),r.jsx("div",{className:"p-3 sm:p-6 overflow-y-auto max-h-[calc(95vh-140px)] sm:max-h-[calc(90vh-120px)]",children:(0,r.jsxs)("div",{className:"space-y-3 sm:space-y-6",children:[n&&r.jsx("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 sm:p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-yellow-100 dark:bg-yellow-800/40 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(_.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-600 dark:text-yellow-400"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[r.jsx("h4",{className:"text-sm sm:text-base font-semibold text-yellow-800 dark:text-yellow-200",children:"发现新版本"}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-yellow-700 dark:text-yellow-300 break-all",children:["v",T.w," → v",o]})]})]}),(0,r.jsxs)("a",{href:"https://github.com/MoonTechLab/LunaTV",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white text-xs sm:text-sm rounded-lg transition-colors shadow-sm w-full",children:[r.jsx(_.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"前往仓库"]})]})}),!n&&r.jsx("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3 sm:p-4",children:(0,r.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[r.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-100 dark:bg-green-800/40 rounded-full flex items-center justify-center flex-shrink-0",children:r.jsx(U.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 dark:text-green-400"})}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[r.jsx("h4",{className:"text-sm sm:text-base font-semibold text-green-800 dark:text-green-200",children:"当前为最新版本"}),(0,r.jsxs)("p",{className:"text-xs sm:text-sm text-green-700 dark:text-green-300 break-all",children:["已是最新版本 v",T.w]})]})]}),(0,r.jsxs)("a",{href:"https://github.com/MoonTechLab/LunaTV",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-xs sm:text-sm rounded-lg transition-colors shadow-sm w-full",children:[r.jsx(U.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"前往仓库"]})]})}),n&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[r.jsx(_.Z,{className:"w-5 h-5 text-yellow-500"}),"远程更新内容"]}),r.jsx("button",{onClick:()=>m(!x),className:"inline-flex items-center justify-center gap-2 px-3 py-1.5 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 dark:bg-yellow-800/30 dark:hover:bg-yellow-800/50 dark:text-yellow-200 rounded-lg transition-colors text-sm w-full sm:w-auto",children:x?(0,r.jsxs)(r.Fragment,{children:[r.jsx(L.Z,{className:"w-4 h-4"}),"收起"]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(N.Z,{className:"w-4 h-4"}),"查看更新内容"]})})]}),x&&l.length>0&&r.jsx("div",{className:"space-y-4",children:l.filter(e=>!R.map(e=>e.version).includes(e.version)).map((e,t)=>(0,r.jsxs)("div",{className:`p-4 rounded-lg border ${e.version===o?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-gray-50 dark:bg-gray-800/60 border-gray-200 dark:border-gray-700"}`,children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,r.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["v",e.version]}),e.version===o&&r.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:"远程最新"})]}),r.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:e.date})]}),e.added&&e.added.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-green-600 dark:text-green-400 mb-2 flex items-center gap-1",children:[r.jsx(I.Z,{className:"w-4 h-4"}),"新增功能"]}),r.jsx("ul",{className:"space-y-1",children:e.added.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mt-2 flex-shrink-0"}),e]},t))})]}),e.changed&&e.changed.length>0&&(0,r.jsxs)("div",{className:"mb-3",children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mb-2 flex items-center gap-1",children:[r.jsx(P.Z,{className:"w-4 h-4"}),"功能改进"]}),r.jsx("ul",{className:"space-y-1",children:e.changed.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),e]},t))})]}),e.fixed&&e.fixed.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-400 mb-2 flex items-center gap-1",children:[r.jsx(A.Z,{className:"w-4 h-4"}),"问题修复"]}),r.jsx("ul",{className:"space-y-1",children:e.fixed.map((e,t)=>(0,r.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[r.jsx("span",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),e]},t))})]})]},t))})]}),(0,r.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4",children:[r.jsx("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 pb-3 sm:pb-4",children:"变更日志"}),r.jsx("div",{className:"space-y-4",children:R.map(e=>y(e,e.version===T.w,!1))})]})]})})]})]});return a&&e?(0,E.createPortal)(b,document.body):null},z=()=>{let e=(0,h.useRouter)(),[t,a]=(0,u.useState)(!1),[s,l]=(0,u.useState)(!1),[d,n]=(0,u.useState)(!1),[i,o]=(0,u.useState)(!1),[c,x]=(0,u.useState)(null),[m,g]=(0,u.useState)("localstorage"),[y,b]=(0,u.useState)(!1),[f,_]=(0,u.useState)(!0),[I,P]=(0,u.useState)(""),[A,U]=(0,u.useState)(!0),[L,R]=(0,u.useState)("direct"),[z,M]=(0,u.useState)("direct"),[F,G]=(0,u.useState)(""),[D,B]=(0,u.useState)(!1),[H,W]=(0,u.useState)(!1),q=[{value:"direct",label:"直连（服务器直接请求豆瓣）"},{value:"cors-proxy-zwei",label:"Cors Proxy By Zwei"},{value:"cmliussss-cdn-tencent",label:"豆瓣 CDN By CMLiussss（腾讯云）"},{value:"cmliussss-cdn-ali",label:"豆瓣 CDN By CMLiussss（阿里云）"},{value:"cors-anywhere",label:"Cors Anywhere（20 qpm）"},{value:"custom",label:"自定义代理"}],V=[{value:"direct",label:"直连（浏览器直接请求豆瓣）"},{value:"server",label:"服务器代理（由服务器代理请求豆瓣）"},{value:"img3",label:"豆瓣精品 CDN（阿里云）"},{value:"cmliussss-cdn-tencent",label:"豆瓣 CDN By CMLiussss（腾讯云）"},{value:"cmliussss-cdn-ali",label:"豆瓣 CDN By CMLiussss（阿里云）"},{value:"custom",label:"自定义代理"}],[Y,X]=(0,u.useState)(""),[J,K]=(0,u.useState)(""),[Q,ee]=(0,u.useState)(!1),[et,ea]=(0,u.useState)(""),[er,es]=(0,u.useState)(null),[el,ed]=(0,u.useState)(!0);(0,u.useEffect)(()=>{b(!0)},[]),(0,u.useEffect)(()=>{},[]),(0,u.useEffect)(()=>{},[]),(0,u.useEffect)(()=>{(async()=>{try{let e=await (0,O.Df)();es(e)}catch(e){console.warn("版本检查失败:",e)}finally{ed(!1)}})()},[]),(0,u.useEffect)(()=>{let e=e=>{D&&!e.target.closest('[data-dropdown="douban-datasource"]')&&B(!1)};if(D)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[D]),(0,u.useEffect)(()=>{let e=e=>{H&&!e.target.closest('[data-dropdown="douban-image-proxy"]')&&W(!1)};if(H)return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[H]);let en=()=>{a(!1)},ei=async()=>{try{await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(e){console.error("注销请求失败:",e)}window.location.href="/"},eo=()=>{n(!1),X(""),K(""),ea("")},ec=async()=>{if(ea(""),!Y){ea("新密码不得为空");return}if(Y!==J){ea("两次输入的密码不一致");return}ee(!0);try{let e=await fetch("/api/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newPassword:Y})}),t=await e.json();if(!e.ok){ea(t.error||"修改密码失败");return}n(!1),await ei()}catch(e){ea("网络错误，请稍后重试")}finally{ee(!1)}},ex=()=>{l(!1)},em=e=>{_(e)},eg=e=>{P(e)},eh=e=>{U(e)},eu=e=>{R(e)},ey=e=>{M(e)},eb=e=>{G(e)},ef=e=>{switch(e){case"cors-proxy-zwei":return{text:"Thanks to @Zwei",url:"https://github.com/bestzwei"};case"cmliussss-cdn-tencent":case"cmliussss-cdn-ali":return{text:"Thanks to @CMLiussss",url:"https://github.com/cmliu"};default:return null}},ep=c?.role==="owner"||c?.role==="admin",ej=c?.role!=="owner"&&"localstorage"!==m,ev=(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-transparent z-[1000]",onClick:en}),(0,r.jsxs)("div",{className:"fixed top-14 right-4 w-56 bg-white dark:bg-gray-900 rounded-lg shadow-xl z-[1001] border border-gray-200/50 dark:border-gray-700/50 overflow-hidden select-none",children:[r.jsx("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100/50 dark:from-gray-800 dark:to-gray-800/50",children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"当前用户"}),r.jsx("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${"owner"===(c?.role||"user")?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":"admin"===(c?.role||"user")?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}`,children:(e=>{switch(e){case"owner":return"站长";case"admin":return"管理员";case"user":return"用户";default:return""}})(c?.role||"user")})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("div",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm truncate",children:c?.username||"default"}),(0,r.jsxs)("div",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:["数据存储：","localstorage"===m?"本地":m]})]})]})}),(0,r.jsxs)("div",{className:"py-1",children:[(0,r.jsxs)("button",{onClick:()=>{a(!1),l(!0)},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[r.jsx(p.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),r.jsx("span",{className:"font-medium",children:"设置"})]}),ep&&(0,r.jsxs)("button",{onClick:()=>{e.push("/admin")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[r.jsx(j.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),r.jsx("span",{className:"font-medium",children:"管理面板"})]}),ej&&(0,r.jsxs)("button",{onClick:()=>{a(!1),n(!0),X(""),K(""),ea("")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[r.jsx(v.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),r.jsx("span",{className:"font-medium",children:"修改密码"})]}),r.jsx("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),(0,r.jsxs)("button",{onClick:ei,className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-sm",children:[r.jsx(k.Z,{className:"w-4 h-4"}),r.jsx("span",{className:"font-medium",children:"登出"})]}),r.jsx("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),r.jsx("button",{onClick:()=>{o(!0),en()},className:"w-full px-3 py-2 text-center flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors text-xs",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)("span",{className:"font-mono",children:["v",T.w]}),!el&&er&&er!==O.qu.FETCH_FAILED&&r.jsx("div",{className:`w-2 h-2 rounded-full -translate-y-2 ${er===O.qu.HAS_UPDATE?"bg-yellow-500":er===O.qu.NO_UPDATE?"bg-green-400":""}`})]})})]})]})]}),ek=(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:ex}),(0,r.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-xl max-h-[90vh] bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6 overflow-y-auto",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"本地设置"}),r.jsx("button",{onClick:()=>{let e=window.RUNTIME_CONFIG?.DOUBAN_PROXY_TYPE||"direct",t=window.RUNTIME_CONFIG?.DOUBAN_PROXY||"",a=window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY_TYPE||"direct",r=window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY||"";_(!0),U(!0),P(t),R(e),M(a),G(r)},className:"px-2 py-1 text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 border border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"重置为默认设置",children:"恢复默认"})]}),r.jsx("button",{onClick:ex,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:r.jsx(w.Z,{className:"w-full h-full"})})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"豆瓣数据代理"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"选择获取豆瓣数据的方式"})]}),(0,r.jsxs)("div",{className:"relative","data-dropdown":"douban-datasource",children:[r.jsx("button",{type:"button",onClick:()=>B(!D),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:border-gray-400 dark:hover:border-gray-500 text-left",children:q.find(e=>e.value===L)?.label}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:r.jsx(N.Z,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform duration-200 ${D?"rotate-180":""}`})}),D&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:q.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{eu(e.value),B(!1)},className:`w-full px-3 py-2.5 text-left text-sm transition-colors duration-150 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 ${L===e.value?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"}`,children:[r.jsx("span",{className:"truncate",children:e.label}),L===e.value&&r.jsx(C.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 ml-2"})]},e.value))})]}),ef(L)&&r.jsx("div",{className:"mt-3",children:(0,r.jsxs)("button",{type:"button",onClick:()=>window.open(ef(L).url,"_blank"),className:"flex items-center justify-center gap-1.5 w-full px-3 text-xs text-gray-500 dark:text-gray-400 cursor-pointer",children:[r.jsx("span",{className:"font-medium",children:ef(L).text}),r.jsx(S.Z,{className:"w-3.5 opacity-70"})]})})]}),"custom"===L&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"豆瓣代理地址"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"自定义代理服务器地址"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 shadow-sm hover:border-gray-400 dark:hover:border-gray-500",placeholder:"例如: https://proxy.example.com/fetch?url=",value:I,onChange:e=>eg(e.target.value)})]}),r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"豆瓣图片代理"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"选择获取豆瓣图片的方式"})]}),(0,r.jsxs)("div",{className:"relative","data-dropdown":"douban-image-proxy",children:[r.jsx("button",{type:"button",onClick:()=>W(!H),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:border-gray-400 dark:hover:border-gray-500 text-left",children:V.find(e=>e.value===z)?.label}),r.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:r.jsx(N.Z,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform duration-200 ${D?"rotate-180":""}`})}),H&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:V.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>{ey(e.value),W(!1)},className:`w-full px-3 py-2.5 text-left text-sm transition-colors duration-150 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 ${z===e.value?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"}`,children:[r.jsx("span",{className:"truncate",children:e.label}),z===e.value&&r.jsx(C.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 ml-2"})]},e.value))})]}),ef(z)&&r.jsx("div",{className:"mt-3",children:(0,r.jsxs)("button",{type:"button",onClick:()=>window.open(ef(z).url,"_blank"),className:"flex items-center justify-center gap-1.5 w-full px-3 text-xs text-gray-500 dark:text-gray-400 cursor-pointer",children:[r.jsx("span",{className:"font-medium",children:ef(z).text}),r.jsx(S.Z,{className:"w-3.5 opacity-70"})]})})]}),"custom"===z&&(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"豆瓣图片代理地址"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"自定义图片代理服务器地址"})]}),r.jsx("input",{type:"text",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 shadow-sm hover:border-gray-400 dark:hover:border-gray-500",placeholder:"例如: https://proxy.example.com/fetch?url=",value:F,onChange:e=>eb(e.target.value)})]}),r.jsx("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"默认聚合搜索结果"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"搜索时默认按标题和年份聚合显示结果"})]}),r.jsx("label",{className:"flex items-center cursor-pointer",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:f,onChange:e=>em(e.target.checked)}),r.jsx("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),r.jsx("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"启用优选和测速"}),r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"如出现播放器劫持问题可关闭"})]}),r.jsx("label",{className:"flex items-center cursor-pointer",children:(0,r.jsxs)("div",{className:"relative",children:[r.jsx("input",{type:"checkbox",className:"sr-only peer",checked:A,onChange:e=>eh(e.target.checked)}),r.jsx("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),r.jsx("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]})]}),r.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"这些设置保存在本地浏览器中"})})]})]}),ew=(0,r.jsxs)(r.Fragment,{children:[r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:eo}),(0,r.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"修改密码"}),r.jsx("button",{onClick:eo,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:r.jsx(w.Z,{className:"w-full h-full"})})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"新密码"}),r.jsx("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"请输入新密码",value:Y,onChange:e=>X(e.target.value),disabled:Q})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"确认密码"}),r.jsx("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"请再次输入新密码",value:J,onChange:e=>K(e.target.value),disabled:Q})]}),et&&r.jsx("div",{className:"text-red-500 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:et})]}),(0,r.jsxs)("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[r.jsx("button",{onClick:eo,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors",disabled:Q,children:"取消"}),r.jsx("button",{onClick:ec,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:Q||!Y||!J,children:Q?"修改中...":"确认修改"})]}),r.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:r.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"修改密码后需要重新登录"})})]})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"relative",children:[r.jsx("button",{onClick:()=>{a(!t)},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"User Menu",children:r.jsx(Z.Z,{className:"w-full h-full"})}),er===O.qu.HAS_UPDATE&&r.jsx("div",{className:"absolute top-[2px] right-[2px] w-2 h-2 bg-yellow-500 rounded-full"})]}),t&&y&&(0,E.createPortal)(ev,document.body),s&&y&&(0,E.createPortal)(ek,document.body),d&&y&&(0,E.createPortal)(ew,document.body),r.jsx($,{isOpen:i,onClose:()=>o(!1)})]})},M=({showBackButton:e=!1})=>{let{siteName:t}=(0,b.W)();return(0,r.jsxs)("header",{className:"md:hidden relative w-full bg-white/70 backdrop-blur-xl border-b border-gray-200/50 shadow-sm dark:bg-gray-900/70 dark:border-gray-700/50",children:[(0,r.jsxs)("div",{className:"h-12 flex items-center justify-between px-4",children:[r.jsx("div",{className:"flex items-center gap-2",children:e&&r.jsx(l,{})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx(f.T,{}),r.jsx(z,{})]})]}),r.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:r.jsx(g.default,{href:"/",className:"text-2xl font-bold text-green-600 tracking-tight hover:opacity-80 transition-opacity",children:t})})]})};var F=a(79515);let G=(0,u.createContext)({isCollapsed:!1}),D=()=>{let{siteName:e}=(0,b.W)();return r.jsx(g.default,{href:"/",className:"flex items-center justify-center h-16 select-none hover:opacity-80 transition-opacity duration-200",children:r.jsx("span",{className:"text-2xl font-bold text-green-600 tracking-tight",children:e})})},B=({onToggle:e,activePath:t="/"})=>{let a=(0,h.useRouter)(),s=(0,h.usePathname)(),l=(0,h.useSearchParams)(),[y,b]=(0,u.useState)(()=>!1);(0,u.useLayoutEffect)(()=>{let e=localStorage.getItem("sidebarCollapsed");if(null!==e){let t=JSON.parse(e);b(t),window.__sidebarCollapsed=t}},[]),(0,u.useLayoutEffect)(()=>{"undefined"!=typeof document&&(y?document.documentElement.dataset.sidebarCollapsed="true":delete document.documentElement.dataset.sidebarCollapsed)},[y]);let[f,p]=(0,u.useState)(t);(0,u.useEffect)(()=>{t?p(t):p((()=>{let e=l.toString();return e?`${s}?${e}`:s})())},[t,s,l]);let j=(0,u.useCallback)(()=>{let t=!y;b(t),localStorage.setItem("sidebarCollapsed",JSON.stringify(t)),e?.(t)},[y,e]),v=(0,u.useCallback)(()=>{a.push("/search")},[a]),[k,w]=(0,u.useState)([{icon:i.Z,label:"电影",href:"/douban?type=movie"},{icon:o.Z,label:"剧集",href:"/douban?type=tv"},{icon:c.Z,label:"动漫",href:"/douban?type=anime"},{icon:x.Z,label:"综艺",href:"/douban?type=show"}]);return(0,u.useEffect)(()=>{let e=window.RUNTIME_CONFIG;e?.CUSTOM_CATEGORIES?.length>0&&w(e=>[...e,{icon:m.Z,label:"自定义",href:"/douban?type=custom"}])},[]),r.jsx(G.Provider,{value:{isCollapsed:y},children:(0,r.jsxs)("div",{className:"hidden md:flex",children:[r.jsx("aside",{"data-sidebar":!0,className:`fixed top-0 left-0 h-screen bg-white/40 backdrop-blur-xl transition-all duration-300 border-r border-gray-200/50 z-10 shadow-lg dark:bg-gray-900/70 dark:border-gray-700/50 ${y?"w-16":"w-64"}`,style:{backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)"},children:(0,r.jsxs)("div",{className:"flex h-full flex-col",children:[(0,r.jsxs)("div",{className:"relative h-16",children:[r.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-opacity duration-200 ${y?"opacity-0":"opacity-100"}`,children:r.jsx("div",{className:"w-[calc(100%-4rem)] flex justify-center",children:!y&&r.jsx(D,{})})}),r.jsx("button",{onClick:j,className:`absolute top-1/2 -translate-y-1/2 flex items-center justify-center w-8 h-8 rounded-lg text-gray-500 hover:text-gray-700 hover:bg-gray-100/50 transition-colors duration-200 z-10 dark:text-gray-400 dark:hover:text-gray-200 dark:hover:bg-gray-700/50 ${y?"left-1/2 -translate-x-1/2":"right-2"}`,children:r.jsx(F.Z,{className:"h-4 w-4"})})]}),(0,r.jsxs)("nav",{className:"px-2 mt-4 space-y-1",children:[(0,r.jsxs)(g.default,{href:"/",onClick:()=>p("/"),"data-active":"/"===f,className:`group flex items-center rounded-lg px-2 py-2 pl-4 text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ${y?"w-full max-w-none mx-0":"mx-0"} gap-3 justify-start`,children:[r.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:r.jsx(d.Z,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&r.jsx("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:"首页"})]}),(0,r.jsxs)(g.default,{href:"/search",onClick:e=>{e.preventDefault(),v(),p("/search")},"data-active":"/search"===f,className:`group flex items-center rounded-lg px-2 py-2 pl-4 text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 font-medium transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ${y?"w-full max-w-none mx-0":"mx-0"} gap-3 justify-start`,children:[r.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:r.jsx(n.Z,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&r.jsx("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:"搜索"})]})]}),r.jsx("div",{className:"flex-1 overflow-y-auto px-2 pt-4",children:r.jsx("div",{className:"space-y-1",children:k.map(e=>{let t=e.href.match(/type=([^&]+)/)?.[1],a=decodeURIComponent(f),s=a===decodeURIComponent(e.href)||a.startsWith("/douban")&&a.includes(`type=${t}`),l=e.icon;return(0,r.jsxs)(g.default,{href:e.href,onClick:()=>p(e.href),"data-active":s,className:`group flex items-center rounded-lg px-2 py-2 pl-4 text-sm text-gray-700 hover:bg-gray-100/30 hover:text-green-600 data-[active=true]:bg-green-500/20 data-[active=true]:text-green-700 transition-colors duration-200 min-h-[40px] dark:text-gray-300 dark:hover:text-green-400 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400 ${y?"w-full max-w-none mx-0":"mx-0"} gap-3 justify-start`,children:[r.jsx("div",{className:"w-4 h-4 flex items-center justify-center",children:r.jsx(l,{className:"h-4 w-4 text-gray-500 group-hover:text-green-600 data-[active=true]:text-green-700 dark:text-gray-400 dark:group-hover:text-green-400 dark:data-[active=true]:text-green-400"})}),!y&&r.jsx("span",{className:"whitespace-nowrap transition-opacity duration-200 opacity-100",children:e.label})]},e.label)})})})]})}),r.jsx("div",{className:`transition-all duration-300 sidebar-offset ${y?"w-16":"w-64"}`})]})})},H=({children:e,activePath:t="/"})=>(0,r.jsxs)("div",{className:"w-full min-h-screen",children:[r.jsx(M,{showBackButton:["/play"].includes(t)}),(0,r.jsxs)("div",{className:"flex md:grid md:grid-cols-[auto_1fr] w-full min-h-screen md:min-h-auto",children:[r.jsx("div",{className:"hidden md:block",children:r.jsx(B,{activePath:t})}),(0,r.jsxs)("div",{className:"relative min-w-0 flex-1 transition-all duration-300",children:[["/play"].includes(t)&&r.jsx("div",{className:"absolute top-3 left-1 z-20 hidden md:flex",children:r.jsx(l,{})}),(0,r.jsxs)("div",{className:"absolute top-2 right-4 z-20 hidden md:flex items-center gap-2",children:[r.jsx(f.T,{}),r.jsx(z,{})]}),r.jsx("main",{className:"flex-1 md:min-h-0 mb-14 md:mb-0",style:{paddingBottom:"calc(3.5rem + env(safe-area-inset-bottom))"},children:e})]})]}),r.jsx("div",{className:"md:hidden",children:r.jsx(y,{activePath:t})})]})},7899:(e,t,a)=>{a.d(t,{v:()=>r});function r(){return null}}};