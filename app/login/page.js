(()=>{var e={};e.id=2626,e.ids=[2626],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},98216:e=>{"use strict";e.exports=require("net")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},6005:e=>{"use strict";e.exports=require("node:crypto")},56578:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>d,pages:()=>u,routeModule:()=>h,tree:()=>c}),r(59758),r(83421),r(85673);var a=r(41118),s=r(20515),n=r(17412),l=r.n(n),i=r(35078),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);r.d(t,o);let c=["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,59758)),"/app/src/app/login/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,83421)),"/app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,85673,23)),"next/dist/client/components/not-found-error"]}],u=["/app/src/app/login/page.tsx"],d="/login/page",p={require:r,loadChunk:()=>Promise.resolve()},h=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},86676:(e,t,r)=>{Promise.resolve().then(r.bind(r,75099))},8906:(e,t,r)=>{"use strict";r.d(t,{Z:()=>o});var a=r(73301);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),n=(...e)=>e.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,a.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:s,className:i="",children:o,iconNode:c,...u},d)=>(0,a.createElement)("svg",{ref:d,...l,width:t,height:t,stroke:e,strokeWidth:s?24*Number(r)/Number(t):r,className:n("lucide",i),...u},[...c.map(([e,t])=>(0,a.createElement)(e,t)),...Array.isArray(o)?o:[o]])),o=(e,t)=>{let r=(0,a.forwardRef)(({className:r,...l},o)=>(0,a.createElement)(i,{ref:o,iconNode:t,className:n(`lucide-${s(e)}`,r),...l}));return r.displayName=`${e}`,r}},17155:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(8906).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},80606:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(8906).Z)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]])},78747:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});let a=(0,r(8906).Z)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]])},18202:(e,t,r)=>{"use strict";var a=r(57708);r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},75099:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var a=r(19681);let s=(0,r(8906).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var n=r(17155),l=r(18202),i=r(73301),o=r(46768),c=r(30045),u=r(72687),d=r(97214);function p(){let[e,t]=(0,i.useState)(null),[r,l]=(0,i.useState)(!0);return(0,a.jsxs)("button",{onClick:()=>window.open("https://github.com/MoonTechLab/LunaTV","_blank"),className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 transition-colors cursor-pointer",children:[(0,a.jsxs)("span",{className:"font-mono",children:["v",o.w]}),!r&&e!==c.qu.FETCH_FAILED&&(0,a.jsxs)("div",{className:`flex items-center gap-1.5 ${e===c.qu.HAS_UPDATE?"text-yellow-600 dark:text-yellow-400":e===c.qu.NO_UPDATE?"text-green-600 dark:text-green-400":""}`,children:[e===c.qu.HAS_UPDATE&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(s,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"font-semibold text-xs",children:"有新版本"})]}),e===c.qu.NO_UPDATE&&(0,a.jsxs)(a.Fragment,{children:[a.jsx(n.Z,{className:"w-3.5 h-3.5"}),a.jsx("span",{className:"font-semibold text-xs",children:"已是最新"})]})]})]})}function h(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),[r,s]=(0,i.useState)(""),[n,o]=(0,i.useState)(""),[c,h]=(0,i.useState)(null),[x,m]=(0,i.useState)(!1),[g,f]=(0,i.useState)(!1),[b,y]=(0,i.useState)(!1),{siteName:w}=(0,u.W)(),k=async a=>{if(a.preventDefault(),h(null),r&&(!g||n))try{m(!0);let a=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:r,...g?{username:n}:{}})});if(a.ok){let r=t.get("redirect")||"/";e.replace(r)}else if(401===a.status)h("密码错误");else{let e=await a.json().catch(()=>({}));h(e.error??"服务器错误")}}catch(e){h("网络错误，请稍后重试")}finally{m(!1)}},j=async()=>{if(h(null),r&&n)try{m(!0);let a=await fetch("/api/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:r})});if(a.ok){let r=t.get("redirect")||"/";e.replace(r)}else{let e=await a.json().catch(()=>({}));h(e.error??"服务器错误")}}catch(e){h("网络错误，请稍后重试")}finally{m(!1)}};return(0,a.jsxs)("div",{className:"relative min-h-screen flex items-center justify-center px-4 overflow-hidden",children:[a.jsx("div",{className:"absolute top-4 right-4",children:a.jsx(d.T,{})}),(0,a.jsxs)("div",{className:"relative z-10 w-full max-w-md rounded-3xl bg-gradient-to-b from-white/90 via-white/70 to-white/40 dark:from-zinc-900/90 dark:via-zinc-900/70 dark:to-zinc-900/40 backdrop-blur-xl shadow-2xl p-10 dark:border dark:border-zinc-800",children:[a.jsx("h1",{className:"text-green-600 tracking-tight text-center text-3xl font-extrabold mb-8 bg-clip-text drop-shadow-sm",children:w}),(0,a.jsxs)("form",{onSubmit:k,className:"space-y-8",children:[g&&(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"username",className:"sr-only",children:"用户名"}),a.jsx("input",{id:"username",type:"text",autoComplete:"username",className:"block w-full rounded-lg border-0 py-3 px-4 text-gray-900 dark:text-gray-100 shadow-sm ring-1 ring-white/60 dark:ring-white/20 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:ring-2 focus:ring-green-500 focus:outline-none sm:text-base bg-white/60 dark:bg-zinc-800/60 backdrop-blur",placeholder:"输入用户名",value:n,onChange:e=>o(e.target.value)})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{htmlFor:"password",className:"sr-only",children:"密码"}),a.jsx("input",{id:"password",type:"password",autoComplete:"current-password",className:"block w-full rounded-lg border-0 py-3 px-4 text-gray-900 dark:text-gray-100 shadow-sm ring-1 ring-white/60 dark:ring-white/20 placeholder:text-gray-500 dark:placeholder:text-gray-400 focus:ring-2 focus:ring-green-500 focus:outline-none sm:text-base bg-white/60 dark:bg-zinc-800/60 backdrop-blur",placeholder:"输入访问密码",value:r,onChange:e=>s(e.target.value)})]}),c&&a.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:c}),g&&b?(0,a.jsxs)("div",{className:"flex gap-4",children:[a.jsx("button",{type:"button",onClick:j,disabled:!r||!n||x,className:"flex-1 inline-flex justify-center rounded-lg bg-blue-600 py-3 text-base font-semibold text-white shadow-lg transition-all duration-200 hover:bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50",children:x?"注册中...":"注册"}),a.jsx("button",{type:"submit",disabled:!r||x||g&&!n,className:"flex-1 inline-flex justify-center rounded-lg bg-green-600 py-3 text-base font-semibold text-white shadow-lg transition-all duration-200 hover:from-green-600 hover:to-blue-600 disabled:cursor-not-allowed disabled:opacity-50",children:x?"登录中...":"登录"})]}):a.jsx("button",{type:"submit",disabled:!r||x||g&&!n,className:"inline-flex w-full justify-center rounded-lg bg-green-600 py-3 text-base font-semibold text-white shadow-lg transition-all duration-200 hover:from-green-600 hover:to-blue-600 disabled:cursor-not-allowed disabled:opacity-50",children:x?"登录中...":"登录"})]})]}),a.jsx(p,{})]})}function x(){return a.jsx(i.Suspense,{fallback:a.jsx("div",{children:"Loading..."}),children:a.jsx(h,{})})}},97214:(e,t,r)=>{"use strict";r.d(t,{T:()=>c});var a=r(19681),s=r(78747),n=r(80606),l=r(18202),i=r(66081),o=r(73301);function c(){let[e,t]=(0,o.useState)(!1),{setTheme:r,resolvedTheme:c}=(0,i.F)();(0,l.usePathname)();let u=e=>{let t=document.querySelector('meta[name="theme-color"]');if(t)t.setAttribute("content","dark"===e?"#0c111c":"#f9fbfe");else{let t=document.createElement("meta");t.name="theme-color",t.content="dark"===e?"#0c111c":"#f9fbfe",document.head.appendChild(t)}};return e?a.jsx("button",{onClick:()=>{let e="dark"===c?"light":"dark";if(u(e),!document.startViewTransition){r(e);return}document.startViewTransition(()=>{r(e)})},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Toggle theme",children:"dark"===c?a.jsx(s.Z,{className:"w-full h-full"}):a.jsx(n.Z,{className:"w-full h-full"})}):a.jsx("div",{className:"w-10 h-10"})}},46768:(e,t,r)=>{"use strict";r.d(t,{w:()=>a});let a="2.7.1"},30045:(e,t,r)=>{"use strict";r.d(t,{Df:()=>n,n4:()=>i,qu:()=>a});var a,s=r(46768);async function n(){try{let e=await l("https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/VERSION.txt");if(e)return i(e);let t=await l(["https://raw.githubusercontent.com/MoonTechLab/LunaTV/main/VERSION.txt"][1]);if(t)return i(t);return"fetch_failed"}catch(e){return console.error("版本检查失败:",e),"fetch_failed"}}async function l(e){try{let t=new AbortController,r=setTimeout(()=>t.abort(),5e3),a=Date.now(),s=e.includes("?")?`${e}&_t=${a}`:`${e}?_t=${a}`,n=await fetch(s,{method:"GET",signal:t.signal,headers:{"Content-Type":"text/plain"}});if(clearTimeout(r),!n.ok)throw Error(`HTTP error! status: ${n.status}`);return(await n.text()).trim()}catch(t){return console.warn(`从 ${e} 获取版本信息失败:`,t),null}}function i(e){if(e===s.w)return"no_update";try{let t=s.w.split(".").map(e=>{let t=parseInt(e,10);if(isNaN(t)||t<0)throw Error(`无效的版本号格式: ${s.w}`);return t}),r=e.split(".").map(t=>{let r=parseInt(t,10);if(isNaN(r)||r<0)throw Error(`无效的版本号格式: ${e}`);return r}),a=e=>{if(e.length>=3)return e.slice(0,3);{let t=[...e];for(;t.length<3;)t.push(0);return t}},n=a(t),l=a(r);for(let e=0;e<3;e++){if(l[e]>n[e])return"has_update";if(l[e]<n[e])break}return"no_update"}catch(t){return console.error("版本号比较失败:",t),e!==s.w?"has_update":"no_update"}}!function(e){e.HAS_UPDATE="has_update",e.NO_UPDATE="no_update",e.FETCH_FAILED="fetch_failed"}(a||(a={}))},59758:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(15761).createProxy)(String.raw`/app/src/app/login/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[677,9864,6981,7690,2957],()=>r(56578));module.exports=a})();